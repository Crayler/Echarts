<!DOCTYPE html>
<html style="height: 100%">
<head>
  <meta charset="UTF-8">
  <title>全国各地销售情况</title>
  <script src="echarts.min.js"></script>
  <script src="china.js"></script>
  <style>
    :root {
      --primary-color: #03a892;
      --secondary-color: #64FFDA;
      --tertiary-color: #1DE9B6;
      --text-color: #333333;
      --title-color: #333333;
      --bg-color: #fffcf0;
      --card-bg: #FFFFFF;
      --shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      --border-radius: 12px;
      --font-family: 'Microsoft YaHei', 'PingFang SC', 'Helvetica Neue', Arial, sans-serif;
      --header-bg: #fffcf0;
      --header-text: #333;
    }
    
    html, body {
      margin: 0;
      height: 100%;
      width: 100%;
      font-family: var(--font-family);
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    h1 {
      text-align: center;
      margin: 0;
      padding: 15px 0;
      font-size: 24px;
      color: var(--header-text);
      font-weight: 600;
      letter-spacing: 0.5px;
      background: var(--header-bg);
      box-shadow: none;
      border-bottom: 1px solid #eee8d5;
    }
    
    h1::after {
      display: none;
    }

    .container {
      display: grid;
      grid-template-columns: 1fr 1.5fr 1fr;
      grid-template-rows: 1fr 1fr;
      grid-gap: 20px;
      height: calc(100% - 80px);
      padding: 20px;
      box-sizing: border-box;
    }

    .chart-box {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 10px;
      transition: all 0.3s ease;
      border: none;
      overflow: hidden;
      position: relative;
    }

    .chart-box:hover {
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      transform: translateY(-2px);
    }
    
    .chart-box::before {
      display: none;
    }
    
    .chart-box::after {
      display: none;
    }
    
    .chart-title {
      font-size: 14px;
      color: #555;
      text-align: center;
      margin-bottom: 10px;
      font-weight: bold;
    }
    
    /* 确保图表内容在背景之上 */
    .chart-box > div {
      position: relative;
      z-index: 1;
    }

    #left-top     { grid-column: 1; grid-row: 1; }
    #left-bottom  { grid-column: 1; grid-row: 2; }
    #center       { grid-column: 2; grid-row: 1 / span 2; }
    #right-top    { grid-column: 3; grid-row: 1; }
    #right-bottom { grid-column: 3; grid-row: 2; }
  </style>
</head>
<body>
  <h1>2024年全国各地销售情况分析</h1>
  <div class="container">
    <div id="left-top" class="chart-box">
      <div class="chart-title">一周内各数量统计</div>
    </div>
    <div id="left-bottom" class="chart-box">
      <div class="chart-title">一周内各产品销售情况</div>
    </div>
    <div id="center" class="chart-box">
      <div class="chart-title">全国销售地图</div>
    </div>
    <div id="right-top" class="chart-box">
      <div class="chart-title">各大区年度销售占比</div>
    </div>
    <div id="right-bottom" class="chart-box">
      <div class="chart-title">同行业同产品竞争力分析</div>
    </div>
  </div>

  <script>
    // 统一主题配置
    const theme = {
      colors: ['#03a892', '#f8b195', '#f67280', '#c06c84', '#6c5b7b', '#355c7d', '#99b898'],
      textStyle: {
        fontFamily: 'Microsoft YaHei, PingFang SC, sans-serif',
        color: '#555',
        fontSize: 12
      },
      titleStyle: {
        textStyle: {
          fontSize: 14,
          fontWeight: 'normal',
          color: '#555'
        },
        left: 'center',
        top: 5
      },
      legendStyle: {
        textStyle: {
          fontFamily: 'Microsoft YaHei, PingFang SC, sans-serif',
          fontSize: 12
        },
        top: 25,
        itemGap: 10
      },
      gridStyle: {
        top: 60,
        left: '10%',
        right: '10%',
        bottom: '15%',
        containLabel: true
      },
      tooltipStyle: {
        trigger: 'item',
        backgroundColor: 'rgba(255, 255, 255, 0.95)',
        borderColor: '#eee8d5',
        borderWidth: 1,
        padding: 10,
        textStyle: {
          fontFamily: 'Microsoft YaHei, PingFang SC, sans-serif',
          color: '#555',
          fontSize: 12
        },
        extraCssText: 'box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); border-radius: 4px;'
      }
    };

    function createChart(id, option, onClick) {
      const chart = echarts.init(document.getElementById(id));
      chart.setOption(option);
      window.addEventListener('resize', () => chart.resize());
      if (onClick) chart.on('click', onClick);
      return chart;
    }

    const months = ['1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月'];

    function getCitySalesData(city) {
      const base = Math.floor(Math.random() * 1000 + 500);
      return months.map(() => Math.floor(base + Math.random() * 500));
    }

    function getCityProductData(city) {
      const base = Math.floor(Math.random() * 100 + 50);
      const randomSeries = () => Array.from({ length: 12 }, () => Math.floor(base + Math.random() * 50));
      return {
        '产品A': randomSeries(),
        '产品B': randomSeries(),
        '产品C': randomSeries()
      };
    }

    function getCityProfitData(city) {
      const base = Math.floor(Math.random() * 1000 + 500);
      const randomSeries = () => Array.from({ length: 12 }, () => Math.floor(base + Math.random() * 500));
      return {
        '产品A': randomSeries(),
        '产品B': randomSeries(),
        '产品C': randomSeries()
      };
    }

    // 折线图配置
    let lineChart = createChart('left-top', {
      color: theme.colors,
      title: {
        ...theme.titleStyle,
        text: '上海年度销售利润趋势'
      },
      tooltip: {
        ...theme.tooltipStyle,
        trigger: 'axis'
      },
      legend: {
        ...theme.legendStyle,
        data: ['产品A', '产品B', '产品C']
      },
      grid: theme.gridStyle,
      xAxis: {
        type: 'category',
        data: months,
        axisLine: {
          lineStyle: {
            color: '#ddd'
          }
        },
        axisLabel: {
          color: '#666'
        }
      },
      yAxis: {
        type: 'value',
        axisLine: {
          lineStyle: {
            color: '#ddd'
          }
        },
        axisLabel: {
          color: '#666'
        },
        splitLine: {
          lineStyle: {
            color: '#f0f0f0'
          }
        }
      },
      series: [
        {
          name: '产品A',
          type: 'line',
          smooth: true,
          symbol: 'emptyCircle',
          symbolSize: 8,
          lineStyle: {
            width: 3,
            shadowColor: 'rgba(0, 191, 165, 0.3)',
            shadowBlur: 10
          },
          itemStyle: {
            borderWidth: 2
          },
          data: getCityProfitData('上海')['产品A']
        },
        {
          name: '产品B',
          type: 'line',
          smooth: true,
          symbol: 'emptyCircle',
          symbolSize: 8,
          lineStyle: {
            width: 3,
            shadowColor: 'rgba(0, 191, 165, 0.3)',
            shadowBlur: 10
          },
          itemStyle: {
            borderWidth: 2
          },
          data: getCityProfitData('上海')['产品B']
        },
        {
          name: '产品C',
          type: 'line',
          smooth: true,
          symbol: 'emptyCircle',
          symbolSize: 8,
          lineStyle: {
            width: 3,
            shadowColor: 'rgba(0, 191, 165, 0.3)',
            shadowBlur: 10
          },
          itemStyle: {
            borderWidth: 2
          },
          data: getCityProfitData('上海')['产品C']
        }
      ]
    });

    // 柱状图配置
    let barChart = createChart('left-bottom', {
      color: theme.colors,
      title: {
        ...theme.titleStyle,
        text: '上海三种产品销售情况'
      },
      tooltip: {
        ...theme.tooltipStyle,
        trigger: 'axis',
        axisPointer: {
          type: 'shadow'
        }
      },
      legend: {
        ...theme.legendStyle,
        data: ['产品A', '产品B', '产品C']
      },
      grid: theme.gridStyle,
      xAxis: {
        type: 'category',
        data: months,
        axisLine: {
          lineStyle: {
            color: '#ddd'
          }
        },
        axisLabel: {
          color: '#666'
        }
      },
      yAxis: {
        type: 'value',
        axisLine: {
          lineStyle: {
            color: '#ddd'
          }
        },
        axisLabel: {
          color: '#666'
        },
        splitLine: {
          lineStyle: {
            color: '#f0f0f0'
          }
        }
      },
      series: [
        {
          name: '产品A',
          type: 'bar',
          barWidth: '20%',
          data: getCityProductData('上海')['产品A']
        },
        {
          name: '产品B',
          type: 'bar',
          barWidth: '20%',
          data: getCityProductData('上海')['产品B']
        },
        {
          name: '产品C',
          type: 'bar',
          barWidth: '20%',
          data: getCityProductData('上海')['产品C']
        }
      ]
    });

    // 地图数据
    const mapData = [
      { name: '北京', value: 1205 },
      { name: '上海', value: 2000 },
      { name: '广州', value: 1500 },
      { name: '湖北', value: 8450 },
      { name: '四川', value: 7800 },
      { name: '山西', value: 1100 },
      { name: '陕西', value: 3945 },
      { name: '重庆', value: 1300 },
      { name: '江苏', value: 6050 },
      { name: '江西', value: 140 },
      { name: '新疆', value: 2585 },
      { name: '西藏', value: 7675 },
      { name: '青海', value: 6465 },
      { name: '黑龙江', value: 1560 },
      { name: '吉林', value: 7100 },
      { name: '辽宁', value: 1810 },
      { name: '内蒙古', value: 5000 },
      { name: '福建', value: 4100 },
      { name: '广东', value: 1100 },
      { name: '甘肃', value: 5737 },
      { name: '云南', value: 1100 },
      { name: '浙江', value: 4110 },
      { name: '山东', value: 7100 },
      { name: '安徽', value: 2110 },
      { name: '贵州', value: 1510 },
      { name: '广西', value: 5780 },
      { name: '海南', value: 3100 },
      { name: '台湾', value: 1340 },
      { name: '天津', value: 1110 },
      { name: '河北', value: 5150 },
      { name: '香港', value: 9100 },
      { name: '宁夏', value: 1710 },
      { name: '河南', value: 5430 },
      { name: '湖南', value: 9700 },
    ]; 

    // 地图图表
    createChart('center', {
      color: theme.colors,
      title: {
        ...theme.titleStyle,
        text: '全国销售地图'
      },
      tooltip: {
        ...theme.tooltipStyle,
        formatter: params => `${params.name}<br/><span style="color:${theme.colors[0]}">销售额: ${params.value || 0} 万元</span>`
      },
      visualMap: {
        min: 0,
        max: 10000,
        left: 'right',
        top: 'bottom',
        text: ['高', '低'],
        calculable: true,
        inRange: {
          color: ['#E0F2F1', '#B2DFDB', '#80CBC4', '#4DB6AC', '#00897B']
        },
        textStyle: theme.textStyle
      },
      series: [{
        name: '销售额',
        type: 'map',
        map: 'china',
        roam: true,
        emphasis: {
          label: {
            show: true,
            color: '#fff'
          },
          itemStyle: {
            areaColor: '#389BB7',
            borderWidth: 1
          }
        },
        itemStyle: {
          areaColor: '#f5f5f5',
          borderColor: '#ccc',
          borderWidth: 0.5
        },
        label: {
          show: true,
          fontSize: 10,
          color: '#333'
        },
        data: mapData
      }]
    }, function (params) {
      const city = params.name;
      const newSales = getCitySalesData(city);
      const newProducts = getCityProductData(city);

      lineChart.setOption({
        title: { text: `${city}年度销售利润趋势` },
        series: [
          { name: '产品A', data: getCityProfitData(city)['产品A'] },
          { name: '产品B', data: getCityProfitData(city)['产品B'] },
          { name: '产品C', data: getCityProfitData(city)['产品C'] }
        ]
      });

      barChart.setOption({
        title: { text: `${city}三种产品销售情况` },
        series: [
          { name: '产品A', data: newProducts['产品A'] },
          { name: '产品B', data: newProducts['产品B'] },
          { name: '产品C', data: newProducts['产品C'] }
        ]
      });
    });

    // 区域销售数据计算
    const regionMap = {
      '华东': ['上海', '江苏', '浙江', '山东', '安徽', '福建', '江西'],
      '华北': ['北京', '天津', '河北', '山西', '内蒙古'],
      '西北': ['陕西', '甘肃', '青海', '宁夏', '新疆'],
      '西南': ['四川', '重庆', '云南', '贵州', '西藏'],
      '华中': ['河南', '湖北', '湖南'],
      '华南': ['广东', '广西', '海南']
    };
    
    const regionTotals = { 
      '华东': 0, '华北': 0, '西北': 0, 
      '西南': 0, '华中': 0, '华南': 0, 
      '其他地区': 0 
    };
    
    mapData.forEach(item => {
      let added = false;
      for (const region in regionMap) {
        if (regionMap[region].includes(item.name)) {
          regionTotals[region] += item.value;
          added = true;
          break;
        }
      }
      if (!added) regionTotals['其他地区'] += item.value;
    });
    
    const totalSales = Object.values(regionTotals).reduce((sum, val) => sum + val, 0);
    const regionSalesData = Object.entries(regionTotals)
      .filter(([name]) => name !== '其他地区')
      .map(([name, value]) => ({ 
        name, 
        value,
        itemStyle: {
          color: theme.colors[Object.keys(regionTotals).indexOf(name) % theme.colors.length]
        }
      }));

    // 饼图配置
    createChart('right-top', {
      color: theme.colors,
      title: {
        ...theme.titleStyle,
        text: '各大区年度销售占比'
      },
      tooltip: {
        ...theme.tooltipStyle,
        formatter: params => {
          const percent = ((params.value / totalSales) * 100).toFixed(2);
          return `${params.name}<br/>销售额: ${params.value}万元<br/>占比: ${percent}%`;
        }
      },
      legend: {
        ...theme.legendStyle,
        orient: 'vertical',
        right: 10,
        top: 'center',
        data: regionSalesData.map(item => item.name)
      },
      series: [{
        name: '销售占比',
        type: 'pie',
        radius: ['50%', '70%'],
        center: ['40%', '50%'],
        avoidLabelOverlap: false,
        itemStyle: {
          borderRadius: 6,
          borderColor: '#fff',
          borderWidth: 2
        },
        label: {
          show: false,
          position: 'center'
        },
        emphasis: {
          label: {
            show: true,
            fontSize: '16',
            fontWeight: 'bold',
            formatter: '{b}\n{d}%'
          }
        },
        labelLine: {
          show: false
        },
        data: regionSalesData
      }]
    });

    // 雷达图配置
    createChart('right-bottom', {
      color: theme.colors.slice(0, 3),
      title: {
        ...theme.titleStyle,
        text: '同行业同产品竞争力分析',
        top: 1,
        left: 'center',
        textStyle: {
          fontSize: 16,
          fontWeight: 'bold'
        }
      },
      tooltip: {
        ...theme.tooltipStyle,
        trigger: 'item'
      },
      legend: {
        textStyle: {
          fontFamily: 'Microsoft YaHei, PingFang SC, sans-serif',
          fontSize: 10
        },
        itemWidth: 12,
        itemHeight: 8,
        itemGap: 5,
        data: ['产品A', '产品B', '产品C'],
        orient: 'vertical',
        right: 10,
        top: 35
      },
      radar: {
        indicator: [
          { name: '市场份额', max: 100 },
          { name: '品牌知名度', max: 100 },
          { name: '用户满意度', max: 100 },
          { name: '售后服务', max: 100 },
          { name: '成本控制', max: 100 }
        ],
        radius: '75%',
        center: ['50%', '60%'],
        splitNumber: 4,
        shape: 'polygon',
        axisName: {
          color: '#00796B',
          fontSize: 12,
          backgroundColor: 'rgba(100, 255, 218, 0.1)',
          borderRadius: 3,
          padding: [3, 5]
        },
        splitLine: {
          lineStyle: {
            color: 'rgba(0, 191, 165, 0.2)'
          }
        },
        splitArea: {
          show: true,
          areaStyle: {
            color: ['rgba(0, 191, 165, 0.02)', 'rgba(0, 191, 165, 0.05)']
          }
        },
        axisLine: {
          lineStyle: {
            color: 'rgba(0, 191, 165, 0.3)'
          }
        }
      },
      series: [{
        name: '竞争力指标对比',
        type: 'radar',
        emphasis: {
          lineStyle: {
            width: 4
          }
        },
        data: [
          {
            value: [85, 90, 48, 50, 75],
            name: '产品A',
            symbol: 'circle',
            symbolSize: 6,
            lineStyle: {
              width: 2
            },
            areaStyle: {
              opacity: 0.2
            }
          },
          {
            value: [78, 72, 79, 85, 97],
            name: '产品B',
            symbol: 'circle',
            symbolSize: 6,
            lineStyle: {
              width: 2
            },
            areaStyle: {
              opacity: 0.2
            }
          },
          {
            value: [90, 95, 93, 78, 80],
            name: '产品C',
            symbol: 'circle',
            symbolSize: 6,
            lineStyle: {
              width: 2
            },
            areaStyle: {
              opacity: 0.2
            }
          }
        ]
      }]
    });
  </script>
</body>
</html>
